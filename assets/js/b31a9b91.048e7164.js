"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[5687],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>f});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),u=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=u(r),m=i,f=c["".concat(l,".").concat(m)]||c[m]||d[m]||a;return r?n.createElement(f,s(s({ref:t},p),{},{components:r})):n.createElement(f,s({ref:t},p))}));function f(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,s=new Array(a);s[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:i,s[1]=o;for(var u=2;u<a;u++)s[u]=r[u];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},52:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>u});var n=r(7462),i=(r(7294),r(3905));const a={description:"Resource Request Pipelines",title:"Pipelines"},s="Resource Request Pipelines",o={unversionedId:"main/reference/resource-requests/pipelines",id:"main/reference/resource-requests/pipelines",title:"Pipelines",description:"Resource Request Pipelines",source:"@site/docs/main/05-reference/04-resource-requests/02-pipelines.md",sourceDirName:"main/05-reference/04-resource-requests",slug:"/main/reference/resource-requests/pipelines",permalink:"/docs/main/reference/resource-requests/pipelines",draft:!1,editUrl:"https://github.com/syntasso/kratix-docs/tree/main/docs/main/05-reference/04-resource-requests/02-pipelines.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{description:"Resource Request Pipelines",title:"Pipelines"},sidebar:"mainSidebar",previous:{title:"Resource Requests",permalink:"/docs/main/reference/resource-requests/intro"},next:{title:"Deleting",permalink:"/docs/main/reference/resource-requests/deleting-a-resource-request"}},l={},u=[{value:"Pipeline images",id:"pipeline-images",level:2},{value:"Passing data between pipeline steps",id:"passing-data-between-pipeline-steps",level:2},{value:"Pipeline runs",id:"pipeline-runs",level:2}],p={toc:u};function c(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"resource-request-pipelines"},"Resource Request Pipelines"),(0,i.kt)("p",null,"The pipeline is an ordered list of OCI images run as an ordered set of init containers in a Kubernetes pod and each container is given read and write access to the same storage."),(0,i.kt)("h2",{id:"pipeline-images"},"Pipeline images"),(0,i.kt)("p",null,"These images can be any OCI image that can be run as a Kubernetes container."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Kubernetes uses ",(0,i.kt)("inlineCode",{parentName:"p"},"docker.io")," as it's default registry. If you choose to store your images in another registery, be sure to provide for the full path (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"ghcr.io/syntasso/kratix-marketplace/jenkins-request-pipeline:v0.1.0"),", not just ",(0,i.kt)("inlineCode",{parentName:"p"},"syntasso/kratix-marketplace/jenkins-request-pipeline:v0.1.0"),")")),(0,i.kt)("h2",{id:"passing-data-between-pipeline-steps"},"Passing data between pipeline steps"),(0,i.kt)("p",null,"There are three mount points, all of which are read-write and can be altered by each pipeline stage:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/input"),": Files made available to the pipeline stage. This is a read/write directory which means each stage can add, remove, or edit inputs to the next stage. The Resource Request itself is initially stored as ",(0,i.kt)("inlineCode",{parentName:"li"},"object.yaml")," in this directory."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/output"),": At the end of a pipeline, each file in this directory will be written to your GitOps repository of choice. At this time, all files must be written to the root directory (i.e. there should not be any subdirectories within ",(0,i.kt)("inlineCode",{parentName:"li"},"/output"),") and every file must contain only valid Kubernetes documents that can be applied to a cluster. Each document will be scheduled per the ",(0,i.kt)("a",{parentName:"li",href:"/docs/main/reference/scheduling"},"scheduling docs"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/metadata"),": This directory can hold non-Kubernetes document files that are used when scheduling output files. At this time, the only known file for this directory is ",(0,i.kt)("inlineCode",{parentName:"li"},"cluster-selectors.yaml")," which added to any Promise cluster-selectors to further refine where the output resources will be ",(0,i.kt)("a",{parentName:"li",href:"/docs/main/reference/scheduling#pipeline"},"scheduled"),".")),(0,i.kt)("h2",{id:"pipeline-runs"},"Pipeline runs"),(0,i.kt)("p",null,"A pipeline is run on each Resource Request reconciliation loop. Kuberentes reconciles on a number of different actions including, but not limited to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Regular interval (default: 10 hours, not currently configurable)"),(0,i.kt)("li",{parentName:"ul"},"Recreating or restarting Kratix Controller"),(0,i.kt)("li",{parentName:"ul"},"A change to the Resource Request (not yet supported)")),(0,i.kt)("p",null,"Therefore, all pipelines should be idempotent as there is a guarantee that they will be run multiple times a day, and may be run much more frequently depending on other environmental impacts like pod restarts."))}c.isMDXComponent=!0}}]);